\documentclass[a4paper,10pt]{jarticle}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage[dvipdfmx]{graphicx}
\usepackage{here}
\usepackage{longtable}
\usepackage{url}
\usepackage{listings}
\usepackage{color}
\setlength{\textwidth}{165mm}
\setlength{\marginparwidth}{40mm}
\setlength{\textheight}{225mm}
\setlength{\topmargin}{-5mm}
\setlength{\oddsidemargin}{-3.5mm}
\begin{document}
\title{確率論まとめ}
\maketitle
\section{確率空間}
\subsection{標本空間と事象}
\subsubsection{導入}
はじめに言葉を定義する。
ある試行を行ったときの事象を\textcolor{red}{標本点}と呼ぶ。標本点全体を\textcolor{red}{標本空間}と呼ぶ。
ここで標本空間を$\Omega$で示す。
試行を行った時の発生する事象を$A$で表す。$A$は標本空間の部分集合であり、
$A=\Omega$の時$A$を\textcolor{red}{全事象}、$A$が標本点を持たないとき$A$は\textcolor{red}{空事象}と呼ばれる。なお空事象は$\emptyset$で表される。
事象$A$が起きない事象を\textcolor{red}{補事象}と呼び、$A^C$で表される。

さらに2つ以上の事象を考えてみる。2つの事象$A$と$B$において少なくとも一方が起きるという事象を$A$と$B$の\textcolor{red}{和事象}と呼ばれる。これは$A\cup B$で表される。
また$A$、$B$の両方が起こる事象について\textcolor{red}{積事象}と呼び、$A\cap B$で表される。
$A$、$B$が同時に起こりえないことを\textcolor{red}{排反}と呼ぶ。

実例を示してみよう。サイコロを1回振ったときに結果は1,2,3,4,5,6のいずれかである。このときの結果1つ1つが標本点である。
標本空間は
\begin{equation}
    \Omega = \{1,2,3,4,5,6\}\tag{1,1}
\end{equation}
サイコロを振った時に6以下の自然数が出るという事象は$\Omega$のため全事象、7以上の自然数が出るという事象は空事象となる。
サイコロを振った時に奇数が出る事象を$A$とすると、補事象$A^C$は偶数が出る事象となる。
サイコロを振った時に3以下が出る事象を$B$とすると、$A$と$B$の和事象は$\{1,2,3,5\}$,積事象は$\{1,3\}$となる。
サイコロを振った時に5が出る事象を$C$とすると、$A$と$C$は排反である。

\subsubsection{ド・モルガンの法則}
和事象と積事象の補集合に関する法則である。
具体的には次式で表される。
\begin{equation}
    (A\cup B)^C = A^C\cap B^C\tag{1,2}
\end{equation}
\begin{equation}
    (A\cap B)^C = A^C\cup B^C\tag{1,3}
\end{equation}
ここで導入のサイコロの例をもとに実例を挙げてみよう。$A$はサイコロを振った時に奇数が出る事象、$B$はサイコロを振った時に3以下が出る事象である。
\begin{equation}
    (A\cup B)^C = \{1,2,3,5\}^C=\{4,6\}\tag{1,4}
\end{equation}
\begin{equation}
    A^C\cap B^C = \{1,3,5\}^C\cap\{1,2,3\}^C=\{2,4,6\}\cap\{4,5,6\}=\{4,6\}\tag{1,5}
\end{equation}
\begin{equation}
    (A\cap B)^C = \{1,3\}^C = \{2,4,5,6\}\tag{1,6}
\end{equation}
\begin{equation}
    A^C\cup B^C = \{1,3,5\}^C\cap\{1,2,3\}^C=\{2,4,6\}\cap\{4,5,6\} = \{2,4,5,6\}\tag{1,7}
\end{equation}
\subsubsection{結合法則及び分配法則}
確率の事象にも結合法則及び分配法則が適応可能。具体的には次式で表される。
\begin{equation}
    (A\cup B)\cup C = A\cup B \cup C\tag{1,8}
\end{equation}
\begin{equation}
    (A\cap B)\cap C = A\cap B\cap C \tag{1,9}
\end{equation}
\begin{equation}
    (A\cup B)\cap C = (A\cap C)\cup(B\cap C)\tag{1,10}
\end{equation}
\begin{equation}
    (A\cap B)\cup C = (A\cup C)\cap(B\cup C)\tag{1,11}
\end{equation}
\subsection{確率の定義}
確率とは\textcolor{red}{事象の起きやすさを表す量}である。事象$A$が起きる確率を$P(A)$と表す。
具体的には以下に示す\textcolor{red}{確率の公理}を満たす写像$P(A)$を確立と呼ぶ。
\begin{itemize}
    \item 事象Aに対して$P(A)$は実数である。そして$0\leq P(A)\leq 1$
    \item $P(\Omega)=1$
    \item 互いに排反な事象$A_1,\cdots,A_n$に対して、$P(A_1\cup\cdots\cup A_N)=P(A_1)+\cdots+P(A_n)$
\end{itemize}
\subsection{確率の性質}
確率の公理より簡単に導くことができる性質を以下に示す。
\begin{equation}
    P(\emptyset)=0\tag{1,12}
\end{equation}
\begin{equation}
    P(A^C)= 1-P(A)\tag{1,13}
\end{equation}
\begin{equation}
    A\subset B => P(A) \leq P(B)\tag{1,14}
\end{equation}
\subsubsection{加法定理}
さらに確率の公理より次の等式が成立する。
\begin{equation}
    P(A\cup B) = P(A\cap B^C) +P(A\cap B )+ P(A^C\cap B)\tag{1,15}
\end{equation}
\begin{equation}
    P(A) = P(A\cap B^C) +P(A\cap B)\tag{1,16}
\end{equation}
\begin{equation}
    P(A) = P(A^C\cap B) + P(A\cap B)\tag{1,17}
\end{equation}
これら3式を足すことで\textcolor{red}{加法定理}が得られる。
\begin{equation}
    P(A\cup B )= P(A)+P(B)-P(A\cap B)\tag{1,18}
\end{equation}
\subsection{条件付確率}
2つの事象$A$と$B$に対して、事象$A$が起きたという条件の下で事象$B$が起きるといった確率を\textcolor{red}{条件付確率}と呼び$P(B|A)$と表す。
条件付確率は次式で求めることができる。
\begin{equation}
    P(B|A)=\frac{P(A\cap B)}{P(A)}\tag{1,19}
\end{equation}
また次式を変形すると
\begin{equation}
    P(A\cap B)=P(A)P(B|A)\tag{1,20}
\end{equation}
なおこの式を\textcolor{red}{乗法定理}と呼ぶ。

具体例を考えてみる。
袋Xが1つと袋Yが2つ存在し、袋Xには赤玉3個白玉1個、袋Yには赤玉2個白玉1個あるとする。
袋を1つ選びその中から1つ球をとるということを考える。袋Xを引いたときに白玉を引く確率を考える。
袋Xを引く事象を$A$、白玉を引く事象を$B$とする。$P(A)=\frac{1}{3}$であり、$P(A\cap B)=\frac{1}{12}$
よって条件付確率$P(B|A)=\frac{1}{4}$である。

また袋Yを引く事象を$C$、赤玉を引く事象を$D$とすると、$P(C)=\frac{2}{3}$、$P(D|C)=\frac{1}{2}$のため、乗法定理より$P(C\cap D)=\frac{1}{3}$となる。
もしこの具体例がわからない場合は図示して考えてみるとよい。

\subsection{独立性}
2つの事象$A$と$B$に対して、$P(B|A)=P(B)$となるとき、事象$A$と事象$B$は\textcolor{red}{独立}という。
独立である条件は$A$が$B$に依存しないことである。このとき乗法定理は次のように変形できる。
\begin{equation}
    P(A\cap B) = P(A)P(B)\tag{1,21}
\end{equation}

実例としてサイコロを2回振った時の出目の組み合わせを考えてみる。
1回目に振り奇数が出る事象を$A$、2回目に振り奇数が出る事象を$B$とすると、$A$と$B$はお互い依存していない。
よって$P(A\cap B)= P(A)P(B)=\frac{1}{2}\cdot\frac{1}{2}=\frac{1}{4}$となる。
\subsection{ベイズの定理}
事象$A$が事象$B_1,\cdots,B_k$の事象が発生したときのみに起こりうるということを考える。そして$B_1,\cdots,B_k$以外の事象が発生したときに$A$は起こらないこととする。
つまり事象$B_i$が発生し、事象$A$が起こるような条件を考える。
このとき事象Aが起きたときにそれが$B_i$という事象であったという条件付確率を求める。
この時求める確率は$P(B_i|A)$となる。(1,19)式より、
\begin{equation}
    P(B_i|A) = \frac{P(B_i\cap A)}{P(A)}\tag{1,22}
\end{equation}
ここで$A$というのは条件$B,\cdots,B_k$が起こった上で発生するため、
\begin{equation}
    P(A) =\sum^k_{j=1}P(A\cap B_j)=\sum^k_{j=1}P(B_j)P(A|B_j)\tag{1,23}
\end{equation}
よって次式が成立する。
\begin{equation}
    P(B_i|A) = \frac{P(B_i\cap A)}{\sum^k_{j=1}P(B_j)P(A|B_j)}\tag{1,23}
\end{equation}
なおこの式を\textcolor{red}{ベイズの定理}と呼ぶ。

やはり式だけ見てもわかりずらいため実例を出してみる。
袋B$_1$に赤玉3つ白玉1つ、袋B$_2$に赤玉2つ白玉2つ、袋B$_3$に赤玉3つ白玉2つあるとする。
この時袋B$_i$を選ぶ事象を$B_i$とし、白玉を選ぶ事象を$A$とする。
ここで白玉を引いたときにそれが袋B$_2$から引いたものである確率をベイズの定理を用いて計算する。
まず$B_i$だが3種類の袋を偏りなく選ぶため確率は$\frac{1}{3}$。ここで$P(A|B_1)=\frac{1}{3}$,$P(A|B_2)=\frac{1}{2}$,$P(A|B_3)=\frac{2}{5}$
よってベイズの定理より、
\begin{equation}
    P(B_2|A)=\frac{\frac{1}{3}\cdot\frac{1}{2}}{\frac{1}{3}\cdot\frac{1}{4}+\frac{1}{3}\cdot\frac{1}{2}+\frac{1}{3}\cdot\frac{2}{5}}=\frac{10}{23}\tag{1,24}
\end{equation}
\section{確率変数と確率分布}




\end{document}